<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyPPG.ppg_bm.bm_extraction &mdash; pyPPG 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=8d563738"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            pyPPG
              <img src="../../../_static/logo-hr.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">pyPPG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Filters.html">Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PPG_validation.html">Validation and Benchmarking</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/pyPPG_example.html">pyPPG example code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/PPG_anal.html">Comprehensive PPG Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/PZ_PPG.html">PhysioZoo PPG analysis</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pyPPG</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../../pyPPG.html">pyPPG</a></li>
      <li class="breadcrumb-item active">pyPPG.ppg_bm.bm_extraction</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pyPPG.ppg_bm.bm_extraction</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pyPPG</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">dotmap</span> <span class="kn">import</span> <span class="n">DotMap</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">find_peaks</span>

<span class="c1">###########################################################################</span>
<span class="c1">####################### PPG biomarkers extraction #########################</span>
<span class="c1">###########################################################################</span>

<div class="viewcode-block" id="BmExctator">
<a class="viewcode-back" href="../../../pyPPG.ppg_bm.html#pyPPG.ppg_bm.bm_extraction.BmExctator">[docs]</a>
<span class="k">class</span> <span class="nc">BmExctator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class that extracts the PPG biomarkers.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">DotMap</span><span class="p">,</span> <span class="n">peak_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">peak_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">next_peak_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">next_peak_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">onsets_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">onsets_times</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
                 <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">list_biomarkers</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">fiducials</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :param data: struct of PPG,PPG&#39;, PPG&quot;, PPG&#39;&quot;:</span>

<span class="sd">            - data.ppg: segment of PPG timeseries to analyse and extract biomarkers as a np array</span>
<span class="sd">            - data.vpg: segment of PPG&#39;</span>
<span class="sd">            - data.apg: segment of PPG&quot;</span>
<span class="sd">            - data.jpg: segment of PPG&#39;&quot;</span>
<span class="sd">        :type data: DotMap</span>
<span class="sd">        :param peak_value: PPG peak value</span>
<span class="sd">        :type peak_value: float</span>
<span class="sd">        :param peak_time: the time corresponding to the peak detected</span>
<span class="sd">        :type peak_time: float</span>
<span class="sd">        :param next_peak_value: PPG next peak value</span>
<span class="sd">        :type next_peak_value: float</span>
<span class="sd">        :param next_peak_time: the time corresponding to the peak detected</span>
<span class="sd">        :type next_peak_time: float</span>
<span class="sd">        :param onsets_values: array of PPG two onsets values surrounding the peak</span>
<span class="sd">        :type onsets_values: Numpy array</span>
<span class="sd">        :param onsets_times: array of the two times corresponding to each onset detected</span>
<span class="sd">        :type onsets_times: Numpy array</span>
<span class="sd">        :param sample_rate: segment data sample rate</span>
<span class="sd">        :type sample_rate: int</span>
<span class="sd">        :param list_biomarkers: list of biomarkers</span>
<span class="sd">        :type list_biomarkers: list</span>
<span class="sd">        :param fiducials: location of fiducial points of the given pulse wave</span>
<span class="sd">        :type fiducials: DataFrame</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_biomarkers</span><span class="o">=</span><span class="n">list_biomarkers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ppg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">segment_vpg</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">vpg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">segment_jpg</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">jpg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peak_value</span> <span class="o">=</span> <span class="n">peak_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peak_time</span> <span class="o">=</span> <span class="n">peak_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">next_peak_value</span> <span class="o">=</span> <span class="n">next_peak_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">next_peak_time</span> <span class="o">=</span> <span class="n">next_peak_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span> <span class="o">=</span> <span class="n">onsets_values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span> <span class="o">=</span> <span class="n">onsets_times</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="n">sample_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tdn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tdp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getDicroticNotchDiastolicPeak</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getFirstDerivitivePoints</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Td</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Te</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getSecondDerivitivePoints</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tp1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tp2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getThirdDerivitivePoints</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">map_func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This function assign for each name of biomarkers a function that calculates it</span>

<span class="sd">        :returns my_funcs: a dictionary where the key is the name of the biomarker and the value is the function to call</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">my_funcs</span> <span class="o">=</span> <span class="p">{</span><span class="c1">#PPG signal</span>
                    <span class="s2">&quot;Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getTpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpp&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getTpp()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tsys&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getTsys()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdia&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getTdia()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tsp&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getTsp()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdp&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getTdp()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;deltaT&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_deltaT()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tsw10&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSystolicWidth_d_percent(10)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tsw25&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSystolicWidth_d_percent(25)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tsw33&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSystolicWidth_d_percent(33)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tsw50&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSystolicWidth_d_percent(50)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tsw66&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSystolicWidth_d_percent(66)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tsw75&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSystolicWidth_d_percent(75)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tsw90&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSystolicWidth_d_percent(90)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw10&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getDiastolicWidth_d_percent(10)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw25&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getDiastolicWidth_d_percent(25)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw33&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getDiastolicWidth_d_percent(33)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw50&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getDiastolicWidth_d_percent(50)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw66&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getDiastolicWidth_d_percent(66)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw75&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getDiastolicWidth_d_percent(75)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw90&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getDiastolicWidth_d_percent(90)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpw10&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSumSW_DW(10)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpw25&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSumSW_DW(25)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpw33&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSumSW_DW(33)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpw50&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSumSW_DW(50)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpw66&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSumSW_DW(66)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpw75&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSumSW_DW(75)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpw90&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSumSW_DW(90)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Asp&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSystolicPeak()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Adn&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getDicroticNotchAmplitude()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Adp&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getDiastolicPeak()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Aoff&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getPulseOffsetAmplitude()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;AUCpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getAUCpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;AUCsys&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getAUCsys()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;AUCdia&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getAUCdia()&quot;</span><span class="p">,</span>

                    <span class="c1"># Signal ratios</span>
                    <span class="s2">&quot;IPR&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getIPR()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tsys/Tdia&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tsys_Tdia()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpw25/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tpwx_Tpi(25)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpw50/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tpwx_Tpi(50)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpw75/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tpwx_Tpi(75)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpw25/Tsp&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tpwx_Tsp(25)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpw50/Tsp&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tpwx_Tsp(50)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tpw75/Tsp&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tpwx_Tsp(75)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw10/Tsw10&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tdwx_Tswx(10)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw25/Tsw25&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tdwx_Tswx(25)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw33/Tsw33&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tdwx_Tswx(33)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw50/Tsw50&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tdwx_Tswx(50)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw66/Tsw66&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tdwx_Tswx(66)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw75/Tsw75&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tdwx_Tswx(75)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tdw90/Tsw90&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tdwx_Tswx(90)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tsp/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tsp_Tpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Asp/Aoff&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Asp_Aoff()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Adp/Asp&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Adp_Asp()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;IPA&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getIPA()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tsp/Asp&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tsp_Asp()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Asp/deltaT&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Asp_deltaT()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Asp/(Tpi-Tsp)&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Asp_TpiTsp()&quot;</span><span class="p">,</span>

                    <span class="c1"># PPG derivatives</span>
                    <span class="s2">&quot;u&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_u()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_v()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_w()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_a()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_b()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_c()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_d()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_e()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_f()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tu&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Tu()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tv&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Tv()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tw&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Tw()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Ta&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Ta()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tb&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Tb()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tc&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Tc()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Td&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Td()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Te&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Te()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tf&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Tf()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tb-c&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Tbc()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tb-d&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Tbd()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tp1&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Tp1()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tp2&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Tp2()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tp1-dp&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Tp1_dp()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tp2-dp&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_Tp2_dp()&quot;</span><span class="p">,</span>

                    <span class="c1"># Derivatives ratios</span>
                    <span class="s2">&quot;Tu/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tu_Tpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tv/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tv_Tpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tw/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tw_Tpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Ta/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Ta_Tpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tb/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tb_Tpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tc/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tc_Tpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Td/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Td_Tpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Te/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Te_Tpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Tf/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Tf_Tpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(Tu-Ta)/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_TuTa_Tpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(Tv-Tb)/Tpi&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_TvTb_Tpi()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Au/Asp&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Au_Asp()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Av/Au&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Av_Au()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Aw/Au&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Aw_Au()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Ab/Aa&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Ab_Aa()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Ac/Aa&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Ac_Aa()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Ad/Aa&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Ad_Aa()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Ae/Aa&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Ae_Aa()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Af/Aa&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Af_Aa()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Ap2/Ap1&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_Ap2_Ap1()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(Ac-Ab)/Aa&quot;</span><span class="p">:</span> <span class="s2">&quot;self.get_ratio_AcAb_Aa()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(Ad-Ab)/Aa&quot;</span><span class="p">:</span><span class="s2">&quot;self.get_ratio_AdAb_Aa()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;AGI&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getAGI()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;AGImod&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getAGImod()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;AGIinf&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getAGIinf()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;AI&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getAI()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;RIp1&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getRIp2()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;RIp2&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getRIp2()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;SC&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getSC()&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;IPAD&quot;</span><span class="p">:</span> <span class="s2">&quot;self.getIPAD()&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">my_funcs</span>

    <span class="k">def</span> <span class="nf">get_biomarker_extract_func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This function go through the list of biomarkers and call the function that is relevant to calculate it each biomarker takes two spots in the biomarker vector: one for the average value and one for its standard deviation.</span>

<span class="sd">            :returns biomarkers_vec: a vector of each biomarker avg value and std of the patient&quot;&quot;&quot;</span>
        <span class="n">my_funcs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_func</span><span class="p">()</span>
        <span class="n">biomarkers_vec</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">biomarker</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_biomarkers</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">func_to_call</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">my_funcs</span><span class="p">[</span><span class="n">biomarker</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">func_to_call</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

            <span class="n">biomarkers_vec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func_to_call</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">biomarkers_vec</span>

    <span class="k">def</span> <span class="nf">_getPeaksOnsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the peaks and onsets of a short FILTERED segment of PPG</span>

<span class="sd">        :return: peaks</span>
<span class="sd">        :return: onsets</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">peaks</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">onsets</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">peaks</span><span class="p">,</span> <span class="n">onsets</span>

    <span class="k">def</span> <span class="nf">_getDicroticNotchDiastolicPeak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate Dicrotic Notch and Diastolic Peak of PPG</span>

<span class="sd">        :return: dn: Sample distance from PPG onset to the Dicrotic Notch on PPG</span>
<span class="sd">        :return: dp: Sample distance from PPG onset to the Diastolic Peak on PPG</span>
<span class="sd">        :return: Tdn: Time from PPG onset to the Dicrotic Notch on PPG</span>
<span class="sd">        :return: Tdp: Time from PPG onset to the Diastolic Peak on PPG</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dn</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">dn</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dp</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">dp</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Tdn</span> <span class="o">=</span> <span class="n">dn</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">Tdp</span> <span class="o">=</span> <span class="n">dp</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>

        <span class="k">return</span> <span class="n">dn</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">Tdn</span><span class="p">,</span> <span class="n">Tdp</span>
    <span class="k">def</span> <span class="nf">_getFirstDerivitivePoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate first derivitive points from a SINGLE Onset-Onset segment of PPG&#39;</span>

<span class="sd">        :return: u: Sample distance from PPG onset to the greatest maximum peak between the left systolic onset and the systolic peak on PPG&#39;</span>
<span class="sd">        :return: v: Sample distance from PPG onset to the lowest minimum pits between the systolic peak and the right systolic onset on PPG&#39;</span>
<span class="sd">        :return: w: Sample distance from PPG onset to the first maximum peak after v on PPG&#39;</span>
<span class="sd">        :return: Tu: Time from PPG onset to the greatest maximum peak between the left systolic onset and the systolic peak on PPG&#39;</span>
<span class="sd">        :return: Tv: Time from PPG onset to the lowest minimum pits between the systolic peak and the right systolic onset on PPG&#39;</span>
<span class="sd">        :return: Tw: Time from PPG onset to the first maximum peak after v on PPG&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">u</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">v</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Tu</span> <span class="o">=</span> <span class="n">u</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">Tv</span> <span class="o">=</span> <span class="n">v</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">Tw</span> <span class="o">=</span> <span class="n">w</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>

        <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">Tu</span><span class="p">,</span> <span class="n">Tv</span><span class="p">,</span> <span class="n">Tw</span>

    <span class="k">def</span> <span class="nf">_getSecondDerivitivePoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate second derivitive points from a SINGLE Onset-Onset segment of PPG&quot;</span>

<span class="sd">        :return: a: Sample distance from PPG onset to the first maximum peak between left systolic onset and systolic peak on PPG&quot;</span>
<span class="sd">        :return: b: Sample distance from PPG onset to the first minimum pits after a on PPG&quot;</span>
<span class="sd">        :return: c: Sample distance from PPG onset to the greatest maximum peak between b and e, or if no maximum peak is present then the inflection point on PPG&quot;</span>
<span class="sd">        :return: d: Sample distance from PPG onset to the lowest minimum pits between c and e, or if no minimum pits is present then the inflection point on PPG&quot;</span>
<span class="sd">        :return: e: Sample distance from PPG onset to the greatest maximum peak between the systolic peak and  the right systolic onset on PPG&quot;</span>
<span class="sd">        :return: f: Sample distance from PPG onset to the first minimum pits after e on PPG&quot;</span>
<span class="sd">        :return: Ta: Time from PPG onset to the first maximum peak between left systolic onset and systolic peak on PPG&quot;</span>
<span class="sd">        :return: Tb: Time from PPG onset to the first minimum pits after a on PPG&quot;</span>
<span class="sd">        :return: Tc: Time from PPG onset to the greatest maximum peak between b and e, or if no maximum peak is present then the inflection point on PPG&quot;</span>
<span class="sd">        :return: Td: Time from PPG onset to the lowest minimum pits between c and e, or if no minimum pits is present then the inflection point on PPG&quot;</span>
<span class="sd">        :return: Te: Time from PPG onset to the greatest maximum peak between the systolic peak and  the right systolic onset on PPG&quot;</span>
<span class="sd">        :return: Tf: Time from PPG onset to the first minimum pits after e on PPG&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">a</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">b</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">c</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">d</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">e</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">f</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Ta</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">Tb</span> <span class="o">=</span> <span class="n">b</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">Tc</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">Td</span> <span class="o">=</span> <span class="n">d</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">Te</span> <span class="o">=</span> <span class="n">e</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">Tf</span> <span class="o">=</span> <span class="n">f</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>

        <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">Ta</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Td</span><span class="p">,</span> <span class="n">Te</span><span class="p">,</span> <span class="n">Tf</span>

    <span class="k">def</span> <span class="nf">_getThirdDerivitivePoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate third derivitive points from a SINGLE Onset-Onset segment of PPG&#39;&quot;</span>

<span class="sd">        :return: p1: Sample distance from PPG onset to the first local maximum after b on PPG&#39;&quot;</span>
<span class="sd">        :return: p2: Sample distance from PPG onset to the last local minimum before d, if c = d, then the first local minimum after d on PPG&#39;&quot;</span>
<span class="sd">        :return: Tp1: Time from PPG onset to the first local maximum after b on PPG&#39;&quot;</span>
<span class="sd">        :return: Tp2: Time from PPG onset to last local minimum before d, if c = d, then the first local minimum after d on PPG&#39;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">p1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">p2</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="o">.</span><span class="n">on</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Tp1</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">Tp2</span> <span class="o">=</span> <span class="n">p2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>

        <span class="k">return</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">Tp1</span><span class="p">,</span> <span class="n">Tp2</span>
    <span class="k">def</span> <span class="nf">_find_nearest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This function calculates the index in an array of the closest value to the arg value</span>

<span class="sd">            :param arr: the array where to find the index</span>
<span class="sd">            :param value: the value to be compared with</span>

<span class="sd">            :return: idx: the index of the value closest to the arg value</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">arr</span> <span class="o">-</span> <span class="n">value</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">idx</span>

    <span class="k">def</span> <span class="nf">_getTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; get the time of a value in the PPG waveform  data vector</span>
<span class="sd">            :param vec: the array where to find the index</span>
<span class="sd">            :param val: the value to be compared with</span>
<span class="sd">            :return: index: the index of the value closest to the arg value</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">tmp_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">val</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vec</span><span class="p">))])</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_nearest</span><span class="p">(</span><span class="n">tmp_vec</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">index</span>

    <span class="k">def</span> <span class="nf">_getSysTime_from_val</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; get the time of a value in the PPG waveform  data vector</span>

<span class="sd">            :param val: the value from which we need the time in the timeserie</span>

<span class="sd">            :return: t_data: the time corresponding to the value</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">idx_ons</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">)</span>
        <span class="n">idx_peak</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_time</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">idx_peak</span> <span class="o">-</span> <span class="n">idx_ons</span>
        <span class="n">vec_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="n">idx</span><span class="p">])</span>
        <span class="n">t_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getTime</span><span class="p">(</span><span class="n">vec_data</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="n">t_data</span> <span class="o">=</span> <span class="n">t_val</span> <span class="o">+</span> <span class="n">idx_ons</span>
        <span class="k">return</span> <span class="n">t_data</span>

    <span class="k">def</span> <span class="nf">_getDiaTime_from_val</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; get the time of a value in the PPG waveform  data vector</span>

<span class="sd">            :param val: the value from which we need the time in the timeserie</span>

<span class="sd">            :return: t_data: the time corresponding to the value</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">idx_ons_right</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">)</span>
        <span class="n">idx_ons_left</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">)</span>
        <span class="n">idx_peak</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_time</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">idx_peak</span> <span class="o">-</span> <span class="n">idx_ons_left</span>
        <span class="n">idx2</span> <span class="o">=</span> <span class="n">idx_ons_right</span> <span class="o">-</span> <span class="n">idx_ons_left</span>
        <span class="n">vec_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span> <span class="n">idx2</span><span class="p">])</span>
        <span class="n">t_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getTime</span><span class="p">(</span><span class="n">vec_data</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="n">t_data</span> <span class="o">=</span> <span class="n">t_val</span> <span class="o">+</span> <span class="n">idx_peak</span>
        <span class="k">return</span> <span class="n">t_data</span>

    <span class="k">def</span> <span class="nf">_getBaselineSlope</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; get the baseline slope in the PPG waveform  data vector</span>

<span class="sd">            :return: baseline slope</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">left_onset_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">right_onset_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">left_onset_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">right_onset_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">slope_numerator</span> <span class="o">=</span> <span class="n">right_onset_value</span> <span class="o">-</span> <span class="n">left_onset_value</span>
        <span class="n">slope_denom</span> <span class="o">=</span> <span class="n">right_onset_time</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">-</span> <span class="n">left_onset_time</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="k">return</span> <span class="n">slope_numerator</span><span class="o">/</span><span class="n">slope_denom</span>

    <span class="k">def</span> <span class="nf">_getBaselineCst</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; get the difference between the right and the left onset values</span>

<span class="sd">            :return: cst</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">left_onset_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">right_onset_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">cst</span> <span class="o">=</span> <span class="n">right_onset_value</span> <span class="o">-</span> <span class="n">left_onset_value</span>
        <span class="k">return</span> <span class="n">cst</span>

    <span class="k">def</span> <span class="nf">getTpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tpi which means the Pulse Interval, the time between the pulse onset and pulse offset.</span>

<span class="sd">            :return: Tpi biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">def</span> <span class="nf">getTpp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tpp means the Peak-to-Peak Interval, the time between two consecutive systolic peaks.</span>

<span class="sd">            :return:  Tpp biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cardiac_period</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_peak_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_time</span>
        <span class="k">return</span> <span class="n">cardiac_period</span>

    <span class="k">def</span> <span class="nf">getTsys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tsys means the Systolic Time, the time between the pulse onset and dicrotic notch.</span>

<span class="sd">        :return: Tsys biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Tsys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tdn</span>
        <span class="k">return</span> <span class="n">Tsys</span>

    <span class="k">def</span> <span class="nf">getTdia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tdia means the Diastolic Time, the time between the dicrotic notch and pulse offset.</span>

<span class="sd">        :return: Tdia biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Tdia</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpi</span><span class="p">()</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Tdp</span>
        <span class="k">return</span> <span class="n">Tdia</span>

    <span class="k">def</span> <span class="nf">getTsp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tsp means the Systolic Peak Time, the time between the pulse onset and systolic peak.</span>

<span class="sd">        :return: Tsp biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">left_onset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Tsp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_time</span> <span class="o">-</span> <span class="n">left_onset</span>
        <span class="k">return</span> <span class="n">Tsp</span>

    <span class="k">def</span> <span class="nf">getTdp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tdp means the Diastolic Peak Time, the time between the pulse onset and diastolic peak.</span>

<span class="sd">        :return: Tdp biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Tdp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tdp</span>
        <span class="k">return</span> <span class="n">Tdp</span>

    <span class="k">def</span> <span class="nf">get_deltaT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; deltaT means the Time Delay, the time between the systolic peak and diastolic peak.</span>

<span class="sd">        :return: deltaT biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">deltaT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tdp</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">getTsp</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">deltaT</span>

    <span class="k">def</span> <span class="nf">getSystolicWidth_d_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Systolic Width,</span>
<span class="sd">            the width at x% of the Systolic Peak Amplitude between the pulse onset and systolic peak.</span>

<span class="sd">            :param d: the percentage chosen to calculate the width</span>

<span class="sd">            :return: Tswx biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># value in segment corresponding to d percent of pulse height</span>
        <span class="n">d_percent_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">time_of_d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getSysTime_from_val</span><span class="p">(</span><span class="n">d_percent_val</span><span class="p">)</span>
        <span class="n">Tswx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_time</span> <span class="o">-</span> <span class="p">(</span><span class="n">time_of_d</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Tswx</span>


    <span class="k">def</span> <span class="nf">getDiastolicWidth_d_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Diastolic Width,</span>
<span class="sd">            the width at x% of the Systolic Peak Amplitude between the systolic peak and pulse offset.</span>

<span class="sd">            :param d: the percentage chosen to calculate the width</span>

<span class="sd">            :return: Tdwx biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># value in segment corresponding to d percent of pulse height</span>
        <span class="n">d_percent_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">time_of_d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getDiaTime_from_val</span><span class="p">(</span><span class="n">d_percent_val</span><span class="p">)</span>
        <span class="n">Tdwx</span> <span class="o">=</span> <span class="p">(</span><span class="n">time_of_d</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_time</span>
        <span class="k">return</span> <span class="n">Tdwx</span>

    <span class="k">def</span> <span class="nf">getSumSW_DW</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates Pulse Width,</span>
<span class="sd">            the sum of the Systolic Width and Diastolic Width at x%.</span>

<span class="sd">            :param d: the percentage chosen to calculate the width</span>

<span class="sd">            :return: Tpwx biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tswx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSystolicWidth_d_percent</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">Tdwx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiastolicWidth_d_percent</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Tswx</span> <span class="o">+</span> <span class="n">Tdwx</span>

    <span class="k">def</span> <span class="nf">getSystolicPeak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Systolic Peak Amplitude, the difference in amplitude between the pulse onset and systolic peak.</span>

<span class="sd">            :return: Systolic Peak Amplitude biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sys_peak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">sys_peak</span>
    <span class="k">def</span> <span class="nf">getDicroticNotchAmplitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Dicrotic Notch Amplitude, the difference in amplitude between the pulse onset and the dicrotic notch.</span>

<span class="sd">            :return: Dicrotic Notch Amplitude biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dn_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dn</span><span class="p">]</span>
        <span class="n">dn_amp</span> <span class="o">=</span> <span class="n">dn_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">dn_amp</span>

    <span class="k">def</span> <span class="nf">getDiastolicPeak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Diastolic Peak Amplitude, the difference in amplitude between the pulse onset and the diastolic peak.</span>

<span class="sd">            :return: Diastolic Peak Amplitude biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dp_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dp</span><span class="p">]</span>
        <span class="n">dia_peak</span> <span class="o">=</span> <span class="n">dp_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">dia_peak</span>

    <span class="k">def</span> <span class="nf">getPulseOffsetAmplitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Pulse Offset Amplitude, the difference in amplitude between the pulse onset and pulse offset.</span>

<span class="sd">            :return: Pulse Offset Amplitude biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Aoff</span> <span class="o">=</span> <span class="n">offset_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Aoff</span>

    <span class="k">def</span> <span class="nf">getAUCpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function the Area Under Pulse Interval Curve, the area under the pulse wave between pulse onset and pulse offset.</span>

<span class="sd">            :return: AUCpi biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">left_onset_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">right_onset_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">baseline_shift_slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getBaselineSlope</span><span class="p">()</span>
        <span class="n">baseline_cst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getBaselineCst</span><span class="p">()</span>
        <span class="n">vec_value_between_ons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span>
        <span class="n">num_t</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vec_value_between_ons</span><span class="p">)</span>
        <span class="n">baseline</span> <span class="o">=</span> <span class="n">baseline_shift_slope</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_time</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">+</span> <span class="n">baseline_cst</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_t</span><span class="p">):</span>
            <span class="nb">sum</span> <span class="o">+=</span> <span class="n">vec_value_between_ons</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">baseline_shift_slope</span><span class="o">*</span><span class="p">((</span><span class="n">t</span><span class="o">+</span><span class="n">left_onset_time</span><span class="p">))</span> <span class="o">+</span> <span class="n">baseline_cst</span>
        <span class="n">AUCpi</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="nb">sum</span><span class="o">/</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_value</span> <span class="o">-</span> <span class="n">baseline</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">right_onset_time</span> <span class="o">-</span> <span class="n">left_onset_time</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">AUCpi</span>

    <span class="k">def</span> <span class="nf">getAUCsys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Area Under Systolic Curve, the area under the pulse wave between the pulse onset and dicrotic notch.</span>

<span class="sd">            :return: AUCsys biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">left_onset_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">right_onset_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">baseline_shift_slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getBaselineSlope</span><span class="p">()</span>
        <span class="n">baseline_cst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getBaselineCst</span><span class="p">()</span>
        <span class="n">vec_value_between_ons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span>
        <span class="n">num_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dn</span>
        <span class="n">baseline</span> <span class="o">=</span> <span class="n">baseline_shift_slope</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_time</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">+</span> <span class="n">baseline_cst</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_t</span><span class="p">):</span>
            <span class="nb">sum</span> <span class="o">+=</span> <span class="n">vec_value_between_ons</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">baseline_shift_slope</span><span class="o">*</span><span class="p">((</span><span class="n">t</span><span class="o">+</span><span class="n">left_onset_time</span><span class="p">))</span> <span class="o">+</span> <span class="n">baseline_cst</span>
        <span class="n">AUCsys</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="nb">sum</span><span class="o">/</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_value</span> <span class="o">-</span> <span class="n">baseline</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">right_onset_time</span> <span class="o">-</span> <span class="n">left_onset_time</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">AUCsys</span>

    <span class="k">def</span> <span class="nf">getAUCdia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates Area Under Diastolic Curve, the area under the pulse wave between the dicrotic notch and pulse offset.</span>

<span class="sd">            :return: AUCdia biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">AUCdia</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAUCpi</span><span class="p">()</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">getAUCsys</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">AUCdia</span>

    <span class="k">def</span> <span class="nf">getIPR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Instantaneous Pulse Rate, 60/CP.</span>

<span class="sd">            :return: IPR biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">IPR</span> <span class="o">=</span> <span class="mi">60</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">getTpp</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">IPR</span>

    <span class="k">def</span> <span class="nf">get_ratio_Tsys_Tdia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the Systolic Time to the Diastolic Time.</span>

<span class="sd">            :return: Tsys/Tdia biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tsys_Tdia</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTsys</span><span class="p">()</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">getTdia</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Tsys_Tdia</span>

    <span class="k">def</span> <span class="nf">get_ratio_Tpwx_Tpi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the Pulse Width at x% of the Systolic Peak Amplitude to the Systolic Peak Time.</span>

<span class="sd">            :param d: the percentage chosen to calculate the width</span>

<span class="sd">            :return: The ratio of the Tpi to the Pulse Width biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sys_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSystolicWidth_d_percent</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">dia_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiastolicWidth_d_percent</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">sys_width</span> <span class="o">+</span> <span class="n">dia_width</span>
        <span class="n">Tpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpi</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">width</span><span class="o">/</span><span class="n">Tpi</span>

    <span class="k">def</span> <span class="nf">get_ratio_Tpwx_Tsp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the Pulse Width at x% of the Systolic Peak Amplitude to the Systolic Peak Time.</span>

<span class="sd">            :param d: the percentage chosen to calculate the width</span>

<span class="sd">            :return: Tpwx/Tsp biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tswx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSystolicWidth_d_percent</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">Tdwx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiastolicWidth_d_percent</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">Tpwx</span> <span class="o">=</span> <span class="n">Tswx</span> <span class="o">+</span> <span class="n">Tdwx</span>
        <span class="n">Tsp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSystolicPeakTime</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Tpwx</span><span class="o">/</span><span class="n">Tsp</span>

    <span class="k">def</span> <span class="nf">get_ratio_Tdwx_Tswx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the Diastolic Width to the Systolic Width at x% width.</span>

<span class="sd">            :param d: the percentage chosen to calculate the width</span>

<span class="sd">            :return: Tdwx/Tswx biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tswx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSystolicWidth_d_percent</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">Tdwx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiastolicWidth_d_percent</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Tdwx</span><span class="o">/</span><span class="n">Tswx</span>

    <span class="k">def</span> <span class="nf">get_ratio_Tsp_Tpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the Systolic Peak Time to the Pulse Interval</span>

<span class="sd">            :return: Tsp/Tpi biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tsp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSystolicPeakTime</span><span class="p">()</span>
        <span class="n">Tpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpi</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Tsp</span><span class="o">/</span><span class="n">Tpi</span>

    <span class="k">def</span> <span class="nf">get_ratio_Asp_Aoff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the Systolic Peak Time to the Pulse Interval</span>

<span class="sd">            :return: Asp/Aoff biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Asp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSystolicPeak</span><span class="p">()</span>
        <span class="n">Aoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Asp</span><span class="o">/</span><span class="n">Aoff</span>

    <span class="k">def</span> <span class="nf">get_ratio_Adp_Asp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates Reflection Index, the ratio of the Diastolic Peak Amplitude to the Systolic Peak Amplitude.</span>

<span class="sd">            :return: Reflection Index biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">RI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiastolicPeak</span><span class="p">()</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">getSystolicPeak</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">RI</span>
    <span class="k">def</span> <span class="nf">getIPA</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Inflection Point Area, the ratio of the Area Under Diastolic Curve to the Area Under Systolic Curve.</span>

<span class="sd">            :return: IPA biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">IPA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAUCdia</span><span class="p">()</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">getAUCsys</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">IPA</span>

    <span class="k">def</span> <span class="nf">get_ratio_Tsp_Asp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the Systolic Peak Time to the Systolic Peak Amplitude.</span>

<span class="sd">            :return: Tsp/Asp biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTsp</span><span class="p">()</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">getSystolicPeak</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_ratio_Asp_deltaT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Stiffness Index, the ratio of the Systolic Peak Amplitude to the Time Delay.</span>

<span class="sd">            :return: Stiffness Index biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">SI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSystolicPeak</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getTdp</span><span class="p">()</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">getTsp</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">SI</span>

    <span class="k">def</span> <span class="nf">get_ratio_Asp_TpiTsp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the Systolic Peak Amplitude to the difference between the Pulse Interval and Systolic Peak Time.</span>

<span class="sd">            :return: Asp/(Tpi-Tsp)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpi</span><span class="p">()</span>
        <span class="n">Tsp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSystolicPeakTime</span><span class="p">()</span>
        <span class="n">Asp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSystolicPeak</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Asp</span><span class="o">/</span><span class="p">(</span><span class="n">Tpi</span><span class="o">-</span><span class="n">Tsp</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_u</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; u means the u-point sample, the sample between the pulse onset and u-point.</span>

<span class="sd">            :return: u biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">u</span>


    <span class="k">def</span> <span class="nf">get_v</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; v means the v-point sample, the sample between the pulse onset and v-point.</span>

<span class="sd">            :return: v biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>

    <span class="k">def</span> <span class="nf">get_w</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; w means the w-point sample, the sample between the pulse onset and w-point.</span>

<span class="sd">            :return: w biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span>

    <span class="k">def</span> <span class="nf">get_a</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; a means the a-point sample, the sample between the pulse onset and a-point.</span>

<span class="sd">            :return: a biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>

    <span class="k">def</span> <span class="nf">get_b</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; b means the b-point sample, the sample between the pulse onset and b-point.</span>

<span class="sd">            :return: b biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>

    <span class="k">def</span> <span class="nf">get_c</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; c means the c-point sample, the sample between the pulse onset and c-point.</span>

<span class="sd">            :return: c biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span>

    <span class="k">def</span> <span class="nf">get_d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; d means the d-point sample, the sample between the pulse onset and d-point.</span>

<span class="sd">            :return: d biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span>

    <span class="k">def</span> <span class="nf">get_e</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; e means the e-point sample, the sample between the pulse onset and e-point.</span>

<span class="sd">            :return: e biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span>

    <span class="k">def</span> <span class="nf">get_f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; f means the f-point sample, the sample between the pulse onset and f-point.</span>

<span class="sd">            :return: f biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span>

    <span class="k">def</span> <span class="nf">get_Tu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tu means the u-point time, the time between the pulse onset and u-point.</span>

<span class="sd">            :return: Tu biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tu</span>

    <span class="k">def</span> <span class="nf">get_Tv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tv means the v-point time, the time between the pulse onset and v-point.</span>

<span class="sd">            :return: Tv biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tv</span>

    <span class="k">def</span> <span class="nf">get_Tw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tw means the v-point time, the time between the pulse onset and w-point.</span>

<span class="sd">            :return: Tw biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tw</span>

    <span class="k">def</span> <span class="nf">get_Ta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Ta means the a-point time, the time between the pulse onset and a-point.</span>

<span class="sd">            :return: Ta biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ta</span>

    <span class="k">def</span> <span class="nf">get_Tb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tb means the b-point time, the time between the pulse onset and b-point.</span>

<span class="sd">            :return: Tb biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tb</span>

    <span class="k">def</span> <span class="nf">get_Tc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tc means the c-point time, the time between the pulse onset and c-point.</span>

<span class="sd">            :return: Tb biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span>

    <span class="k">def</span> <span class="nf">get_Td</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Td means the d-point time, the time between the pulse onset and d-point.</span>

<span class="sd">            :return: Td biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Td</span>


    <span class="k">def</span> <span class="nf">get_Te</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Te means the e-point time, the time between the pulse onset and e-point.</span>

<span class="sd">            :return: Te biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Te</span>

    <span class="k">def</span> <span class="nf">get_Tf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tf means the f-point time, the time between the pulse onset and f-point.</span>

<span class="sd">            :return: Tf biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tf</span>

    <span class="k">def</span> <span class="nf">get_Tbc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tbc means the b–c time, the time between the b-point and c-point.</span>

<span class="sd">            :return: Tbc biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Tb</span>

    <span class="k">def</span> <span class="nf">get_Tbd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tbd means the b–d time, the time between the b-point and d-point.</span>

<span class="sd">            :return: Tbd biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Td</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tb</span>

    <span class="k">def</span> <span class="nf">get_Tp1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tp1 means the p1-point time, the time between the pulse onset and p1-point.</span>

<span class="sd">            :return: Tp1 biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tp1</span>

    <span class="k">def</span> <span class="nf">get_Tp2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Tp2 means the p1-point time, the time between the pulse onset and p2-point.</span>

<span class="sd">            :return: Tp2 biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tp2</span>

    <span class="k">def</span> <span class="nf">get_Tp1_dp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculatesthe p1–dia time, the time between the p1-point and diastolic peak.</span>

<span class="sd">            :return: Tdia-Tp1 biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tp1_dia</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dp</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="k">return</span> <span class="n">Tp1_dia</span>

    <span class="k">def</span> <span class="nf">get_Tp2_dp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculatesthe p2–dia time, the time between the p2-point and diastolic peak.</span>

<span class="sd">            :return: Tdia-Tp2 biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tp2_dia</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dp</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="k">return</span> <span class="n">Tp2_dia</span>


    <span class="k">def</span> <span class="nf">get_ratio_Tu_Tpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the u-point time to the Pulse Interval.</span>

<span class="sd">            :return: Tu/Tpi biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Tu</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">T1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpp</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">get_ratio_Tv_Tpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the v-point time to the Pulse Interval.</span>

<span class="sd">            :return: Tv/Tpi biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Tv</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Tv</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpp</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_ratio_Tw_Tpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the w-point time to the Pulse Interval.</span>

<span class="sd">            :return: Tw/Tpi biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Tw</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Tw</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpp</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_ratio_Ta_Tpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the a-point time to the Pulse Interval.</span>

<span class="sd">            :return: Ta/Tpi biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Ta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Ta</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Ta</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpp</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_ratio_Tb_Tpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the b-point time to the Pulse Interval.</span>

<span class="sd">            :return: Tb/Tpi biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Tb</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Tb</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpp</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_ratio_Tc_Tpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the c-point time to the Pulse Interval.</span>

<span class="sd">            :return: Tc/Tpi biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Tc</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Tc</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpp</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_ratio_Td_Tpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the d-point time to the Pulse Interval.</span>

<span class="sd">            :return: Td/Tpi biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Td</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Td</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpp</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_ratio_Te_Tpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the e-point time to the Pulse Interval.</span>

<span class="sd">            :return: Te/Tpi biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Te</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Te</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Te</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpp</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_ratio_Tf_Tpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the f-point time to the Pulse Interval.</span>

<span class="sd">            :return: Tf/Tpi biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Tf</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Tf</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpp</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_ratio_TuTa_Tpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the difference between the u-point time and a-point time to the Pulse Interval.</span>

<span class="sd">            :return: (Tu-Ta)/Tpi biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Ta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Ta</span><span class="p">()</span>
        <span class="n">Tu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Tu</span><span class="p">()</span>
        <span class="n">Tpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpi</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Tu</span> <span class="o">-</span> <span class="n">Ta</span><span class="p">)</span> <span class="o">/</span> <span class="n">Tpi</span>

    <span class="k">def</span> <span class="nf">get_ratio_TvTb_Tpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the difference between the v-point time and b-point time to the Pulse Interval.</span>

<span class="sd">            :return: (Tv-Tb)/Tpi</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Tb</span><span class="p">()</span>
        <span class="n">Tv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_Tv</span><span class="p">()</span>
        <span class="n">Tpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTpi</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Tv</span><span class="o">-</span><span class="n">Tb</span><span class="p">)</span><span class="o">/</span><span class="n">Tpi</span>

    <span class="k">def</span> <span class="nf">get_ratio_Au_Asp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This function calculates the ratio of the u-point amplitude to the Systolic Peak Amplitude.</span>

<span class="sd">            :return: Au/Asp biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">u_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_vpg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_u</span><span class="p">()]</span>
        <span class="n">sp_amp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_value</span>
        <span class="k">return</span> <span class="n">u_max</span> <span class="o">/</span> <span class="n">sp_amp</span>

    <span class="k">def</span> <span class="nf">get_ratio_Av_Au</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This function calculates the ratio of the v-point amplitude to the u-point amplitude.</span>

<span class="sd">            :return: Av/Au biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">u_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_vpg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_u</span><span class="p">()]</span>
        <span class="n">v_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_vpg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_v</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">v_min</span> <span class="o">/</span> <span class="n">u_max</span>

    <span class="k">def</span> <span class="nf">get_ratio_Aw_Au</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This function calculates the ratio of the w-point amplitude to the u-point amplitude.</span>

<span class="sd">            :return: Aw/Au biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">u_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_vpg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_u</span><span class="p">()]</span>
        <span class="n">w_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_vpg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_w</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">w_max</span> <span class="o">/</span> <span class="n">u_max</span>

    <span class="k">def</span> <span class="nf">get_ratio_Ab_Aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This function calculates the ratio of the b-point amplitude to the a-point amplitude.</span>

<span class="sd">            :return: Ab/Aa biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_a</span><span class="p">()]</span>
        <span class="n">b_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_b</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">b_min</span> <span class="o">/</span> <span class="n">a_max</span>

    <span class="k">def</span> <span class="nf">get_ratio_Ac_Aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This function calculates the ratio of the c-point amplitude to the a-point amplitude.</span>

<span class="sd">            :return: Ac/Aa biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_a</span><span class="p">()]</span>
        <span class="n">c_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_c</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">c_max</span> <span class="o">/</span> <span class="n">a_max</span>

    <span class="k">def</span> <span class="nf">get_ratio_Ad_Aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This function calculates the ratio of the d-point amplitude to the a-point amplitude.</span>

<span class="sd">            :return: Ad/Aa biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_a</span><span class="p">()]</span>
        <span class="n">d_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_d</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">d_min</span> <span class="o">/</span> <span class="n">a_max</span>

    <span class="k">def</span> <span class="nf">get_ratio_Ae_Aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This function calculates the ratio of the e-point amplitude to the a-point amplitude.</span>

<span class="sd">            :return: Ae/Aa biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">a_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_a</span><span class="p">()]</span>
        <span class="n">e_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_e</span><span class="p">()]</span>
        <span class="n">ratio_Ae_Aa</span> <span class="o">=</span> <span class="n">e_max</span> <span class="o">/</span> <span class="n">a_max</span>
        <span class="k">return</span> <span class="n">ratio_Ae_Aa</span>

    <span class="k">def</span> <span class="nf">get_ratio_Af_Aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This function calculates the ratio of the f-point amplitude to the a-point amplitude.</span>

<span class="sd">            :return: Af/Aa biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">a_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_a</span><span class="p">()]</span>
        <span class="n">f_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_f</span><span class="p">()]</span>
        <span class="n">ratio_Af_Aa</span><span class="o">=</span><span class="n">f_min</span> <span class="o">/</span> <span class="n">a_max</span>
        <span class="k">return</span> <span class="n">ratio_Af_Aa</span>

    <span class="k">def</span> <span class="nf">get_ratio_Ap2_Ap1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the p2-point amplitude to the p1-point amplitude.</span>

<span class="sd">            :return: Ap2/Ap1 biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Rp2p1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Rp2p1</span>

    <span class="k">def</span> <span class="nf">get_ratio_AcAb_Aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the difference between the b-point amplitude and c-point amplitude to the a-point amplitude.</span>

<span class="sd">            :return: (Ac-Ab)/Aa biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Aa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_a</span><span class="p">()]</span>
        <span class="n">Ab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_b</span><span class="p">()]</span>
        <span class="n">Ac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_c</span><span class="p">()]</span>
        <span class="n">ratio_AcAb_Aa</span><span class="o">=</span><span class="p">(</span><span class="n">Ac</span><span class="o">-</span><span class="n">Ab</span><span class="p">)</span><span class="o">/</span><span class="n">Aa</span>
        <span class="k">return</span> <span class="n">ratio_AcAb_Aa</span>

    <span class="k">def</span> <span class="nf">get_ratio_AdAb_Aa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of the difference between the b-point amplitude and d-point amplitude to the a-point amplitude.</span>

<span class="sd">            :return: (Ad-Ab)/Aa biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Aa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_a</span><span class="p">()]</span>
        <span class="n">Ab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_b</span><span class="p">()]</span>
        <span class="n">Ad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_d</span><span class="p">()]</span>
        <span class="n">ratio_AdAb_Aa</span><span class="o">=</span><span class="p">(</span><span class="n">Ad</span> <span class="o">-</span> <span class="n">Ab</span><span class="p">)</span> <span class="o">/</span> <span class="n">Aa</span>
        <span class="k">return</span> <span class="n">ratio_AdAb_Aa</span>

    <span class="k">def</span> <span class="nf">getAGI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Aging Index.</span>

<span class="sd">            :return: (Ab-Ac-Ad-Ae)/Aa biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Aa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_a</span><span class="p">()]</span>
        <span class="n">Ab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_b</span><span class="p">()]</span>
        <span class="n">Ac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_c</span><span class="p">()]</span>
        <span class="n">Ad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_d</span><span class="p">()]</span>
        <span class="n">Ae</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_e</span><span class="p">()]</span>
        <span class="n">AGI</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ab</span><span class="o">-</span><span class="n">Ac</span><span class="o">-</span><span class="n">Ad</span><span class="o">-</span><span class="n">Ae</span><span class="p">)</span><span class="o">/</span><span class="n">Aa</span>
        <span class="k">return</span> <span class="n">AGI</span>

    <span class="k">def</span> <span class="nf">getAGImod</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Modified Aging Index.</span>

<span class="sd">            :return: (Ab-Ac-Ad)/Aa biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Aa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_a</span><span class="p">()]</span>
        <span class="n">Ab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_b</span><span class="p">()]</span>
        <span class="n">Ac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_c</span><span class="p">()]</span>
        <span class="n">Ad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_d</span><span class="p">()]</span>
        <span class="n">AGI_mod</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ab</span> <span class="o">-</span> <span class="n">Ac</span> <span class="o">-</span> <span class="n">Ad</span><span class="p">)</span> <span class="o">/</span> <span class="n">Aa</span>
        <span class="k">return</span> <span class="n">AGI_mod</span>

    <span class="k">def</span> <span class="nf">getAGIinf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Informal Aging Index.</span>

<span class="sd">            :return: (Ab-Ae)/Aa biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Aa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_a</span><span class="p">()]</span>
        <span class="n">Ab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_b</span><span class="p">()]</span>
        <span class="n">Ae</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_e</span><span class="p">()]</span>
        <span class="n">AGI_inf</span><span class="o">=</span><span class="p">(</span><span class="n">Ab</span><span class="o">-</span><span class="n">Ae</span><span class="p">)</span><span class="o">/</span><span class="n">Aa</span>
        <span class="k">return</span> <span class="n">AGI_inf</span>

    <span class="k">def</span> <span class="nf">getAI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Augmentation Index, (PPG(Tp2) − PPG(Tp1))/Asp.</span>

<span class="sd">            :return: AI biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">AI</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">])</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_value</span>
        <span class="k">return</span> <span class="n">AI</span>

    <span class="k">def</span> <span class="nf">getRIp1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Reflection Index of p1, Adp/(PPG(Tp1) − PPG(Tpi(0))).</span>

<span class="sd">            :return: RIp1 biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">RIp1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiastolicPeak</span><span class="p">()</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">RIp1</span>

    <span class="k">def</span> <span class="nf">getRIp2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Reflection Index of p2, Adp/(PPG(Tp2) − PPG(Tpi(0))).</span>

<span class="sd">            :return: RIp2 biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">RIp2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiastolicPeak</span><span class="p">()</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">RIp2</span>

    <span class="k">def</span> <span class="nf">getSC</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Spring Constant, PPG&quot;(Tsp)/((Asp-Au)/Asp).</span>

<span class="sd">            :return: SC biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ddxSPA</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">getTsp</span><span class="p">()</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)]</span>
        <span class="n">SPA</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getSystolicPeak</span><span class="p">()</span>
        <span class="n">MS</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">segment_ppg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">]</span>
        <span class="n">SC</span> <span class="o">=</span> <span class="n">ddxSPA</span><span class="o">/</span><span class="p">((</span><span class="n">SPA</span><span class="o">-</span><span class="n">MS</span><span class="p">)</span><span class="o">/</span><span class="n">SPA</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SC</span>

    <span class="k">def</span> <span class="nf">getIPAD</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Inflection point area plus normalised d-point amplitude, AUCdia/AUCsys+Ad/Aa.</span>

<span class="sd">            :return: IPAD biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">IPAD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAUCdia</span><span class="p">()</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">getAUCsys</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ratio_Ad_Aa</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">IPAD</span>
    <span class="k">def</span> <span class="nf">getRatioSW_DW</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio of systolic and diastolic width at d percent of the pulse height</span>

<span class="sd">            :param d: the percentage chosen to calculate the width</span>

<span class="sd">            :return: ratio biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sw_d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSystolicWidth_d_percent</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">dw_d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDiastolicWidth_d_percent</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="n">dw_d</span><span class="o">/</span><span class="n">sw_d</span>
        <span class="k">return</span> <span class="n">ratio</span>

    <span class="k">def</span> <span class="nf">getPIR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the ratio between the peak value and the right onset value</span>

<span class="sd">            :return: pir biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_value</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">pir</span>

    <span class="k">def</span> <span class="nf">getMS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates Maximum slope, PPG&#39;(u)/(PPG(systolic peak) − PPG(systolic onset))</span>

<span class="sd">            :return: MS biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">MS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_vpg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">MS</span>

    <span class="k">def</span> <span class="nf">getUpslope</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates Systolic Upslope between the left onset and the systolic peak.</span>

<span class="sd">            :return: Systolic Upslope</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">left_onset_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span>
        <span class="n">left_onset_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">slope_numer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_value</span><span class="o">-</span><span class="n">left_onset_value</span>
        <span class="n">slope_denom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_time</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">-</span> <span class="n">left_onset_time</span>
        <span class="k">return</span> <span class="n">slope_numer</span><span class="o">/</span><span class="n">slope_denom</span>

    <span class="k">def</span> <span class="nf">getdiffVal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the time between the left onset and the systolic peak.</span>

<span class="sd">            :return: left onset and systolic peak time</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">left_onset_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_value</span> <span class="o">-</span> <span class="n">left_onset_value</span>
        <span class="k">return</span> <span class="n">diff</span>

    <span class="k">def</span> <span class="nf">getSTT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; STT means slope transit time, which based on geometrical considerations of the PPG pulse wave to account for simultaneous.</span>

<span class="sd">            :return: STT biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">upslope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUpslope</span><span class="p">()</span>
        <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getdiffVal</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">A</span><span class="o">/</span><span class="n">upslope</span>

    <span class="k">def</span> <span class="nf">getSystolicPeakTime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Systolic Peak Time means the distance between the consecutive Systolic Peaks</span>

<span class="sd">        :return: Systolic Peak Times</span>
<span class="sd">         &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">onsets_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">getSystolicPeakOutputCurve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Peak time divided by systolic amplitude</span>

<span class="sd">        :return: sys_peak_time/sys_amplitude</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sys_peak_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSystolicPeakTime</span><span class="p">()</span>
        <span class="n">sys_amplitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSystolicPeak</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">sys_peak_time</span><span class="o">/</span><span class="n">sys_amplitude</span>

    <span class="k">def</span> <span class="nf">getAGIext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The function calculates the Extended Aging Index.</span>

<span class="sd">            :return: (Ab-Ac-Ad-Ae-Af)/Aa biomarker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Aa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_a</span><span class="p">()]</span>
        <span class="n">Ab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_b</span><span class="p">()]</span>
        <span class="n">Ac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_c</span><span class="p">()]</span>
        <span class="n">Ad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_d</span><span class="p">()]</span>
        <span class="n">Ae</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_e</span><span class="p">()]</span>
        <span class="n">Af</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment_apg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_e</span><span class="p">()]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Ab</span><span class="o">-</span><span class="n">Ac</span><span class="o">-</span><span class="n">Ad</span><span class="o">-</span><span class="n">Ae</span><span class="o">-</span><span class="n">Af</span><span class="p">)</span><span class="o">/</span><span class="n">Aa</span></div>


<span class="c1">###########################################################################</span>
<span class="c1">############################ Get PPG biomarkers ###########################</span>
<span class="c1">###########################################################################</span>
<div class="viewcode-block" id="get_biomarkers">
<a class="viewcode-back" href="../../../pyPPG.ppg_bm.html#pyPPG.ppg_bm.bm_extraction.get_biomarkers">[docs]</a>
<span class="k">def</span> <span class="nf">get_biomarkers</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">pyPPG</span><span class="o">.</span><span class="n">PPG</span><span class="p">,</span> <span class="n">fp</span><span class="p">:</span> <span class="n">pyPPG</span><span class="o">.</span><span class="n">Fiducials</span><span class="p">,</span> <span class="n">biomarkers_lst</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function calculates the biomedical biomarkers of PPG signal.</span>

<span class="sd">    :param s: object of PPG signal</span>
<span class="sd">    :type s: pyPPG.PPG object</span>
<span class="sd">    :param fp: object of fiducial points</span>
<span class="sd">    :type fp: pyPPG.Fiducials object</span>

<span class="sd">    :return:</span>
<span class="sd">        - df: data frame with onsets, offsets and peaks</span>
<span class="sd">        - df_biomarkers: data frame with PPG signal biomarkers</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fs</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">fs</span>
    <span class="n">ppg</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">ppg</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">DotMap</span><span class="p">()</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;onset&#39;</span><span class="p">,</span><span class="s1">&#39;offset&#39;</span><span class="p">,</span><span class="s1">&#39;peak&#39;</span><span class="p">])</span>
    <span class="n">df_biomarkers</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">biomarkers_lst</span><span class="p">)</span>
    <span class="n">peaks</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">sp</span><span class="o">.</span><span class="n">values</span>
    <span class="n">onsets</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">on</span><span class="o">.</span><span class="n">values</span>
    <span class="n">offsets</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">off</span><span class="o">.</span><span class="n">values</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">onsets</span><span class="p">)):</span>
        <span class="n">onset</span> <span class="o">=</span> <span class="n">onsets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">offsets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">data</span><span class="o">.</span><span class="n">ppg</span> <span class="o">=</span> <span class="n">ppg</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">onset</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">offset</span><span class="p">)]</span>
        <span class="n">data</span><span class="o">.</span><span class="n">vpg</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">vpg</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">onset</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">offset</span><span class="p">)]</span>
        <span class="n">data</span><span class="o">.</span><span class="n">apg</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">apg</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">onset</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">offset</span><span class="p">)]</span>
        <span class="n">data</span><span class="o">.</span><span class="n">jpg</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">jpg</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">onset</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">offset</span><span class="p">)]</span>
        <span class="n">peak</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">[(</span><span class="n">peaks</span> <span class="o">&gt;</span> <span class="n">onset</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">peaks</span> <span class="o">&lt;</span> <span class="n">offset</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">peak</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">peak</span> <span class="o">=</span> <span class="n">peak</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">temp_fiducials</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">get_row</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="n">peak_value</span> <span class="o">=</span> <span class="n">ppg</span><span class="p">[</span><span class="n">peak</span><span class="p">]</span>
        <span class="n">peak_time</span> <span class="o">=</span> <span class="n">peak</span> <span class="o">/</span> <span class="n">fs</span>
        <span class="n">onset_value</span> <span class="o">=</span> <span class="n">ppg</span><span class="p">[</span><span class="n">onset</span><span class="p">]</span>
        <span class="n">onset_time</span> <span class="o">=</span> <span class="n">onset</span> <span class="o">/</span> <span class="n">fs</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">peak_value</span> <span class="o">-</span> <span class="n">onset_value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">offset_value</span> <span class="o">=</span> <span class="n">ppg</span><span class="p">[</span><span class="n">offset</span><span class="p">]</span>
        <span class="n">offset_time</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">/</span> <span class="n">fs</span>

        <span class="n">idx_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">peaks</span> <span class="o">==</span> <span class="n">peak</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">idx_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">onsets_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">onset_value</span><span class="p">,</span> <span class="n">offset_value</span><span class="p">])</span>
        <span class="n">onsets_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">onset_time</span><span class="p">,</span> <span class="n">offset_time</span><span class="p">])</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">peaks</span><span class="p">):</span>
            <span class="n">next_peak_value</span> <span class="o">=</span> <span class="n">ppg</span><span class="p">[</span><span class="n">peaks</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">next_peak_time</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">fs</span>
            <span class="n">next_peak_time</span> <span class="o">=</span> <span class="n">next_peak_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nan_fidu</span><span class="o">=</span><span class="n">temp_fiducials</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">temp_fiducials</span><span class="o">.</span><span class="n">isna</span><span class="p">())[</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">temp_fiducials</span><span class="p">[</span><span class="n">nan_fidu</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                <span class="n">biomarkers_extractor</span> <span class="o">=</span> <span class="n">BmExctator</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">peak_value</span><span class="p">,</span> <span class="n">peak_time</span><span class="p">,</span> <span class="n">next_peak_value</span><span class="p">,</span> <span class="n">next_peak_time</span><span class="p">,</span> <span class="n">onsets_values</span><span class="p">,</span> <span class="n">onsets_times</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">biomarkers_lst</span><span class="p">,</span><span class="n">temp_fiducials</span><span class="p">)</span>
                <span class="n">biomarkers_vec</span> <span class="o">=</span> <span class="n">biomarkers_extractor</span><span class="o">.</span><span class="n">get_biomarker_extract_func</span><span class="p">()</span>
                <span class="n">lst</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">biomarkers_vec</span><span class="p">)</span>
                <span class="n">df_biomarkers</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst</span>
                <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;onset&#39;</span><span class="p">:</span><span class="n">onset</span><span class="p">,</span> <span class="s1">&#39;offset&#39;</span><span class="p">:</span><span class="n">offset</span><span class="p">,</span> <span class="s1">&#39;peak&#39;</span><span class="p">:</span> <span class="n">peak</span><span class="p">}</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="c1"># else:</span>
        <span class="c1">#     print(&quot;no more peaks&quot;)</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">df_biomarkers</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Marton A. GODA, PhD.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>